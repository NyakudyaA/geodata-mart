{% extends "base.html" %}
{% load static i18n %}
{% block extrahead %}

{% endblock extrahead %}

{% block content %}
<main>
  {% include "components/_authenticate.html" %}

  <div class="py-5">
    <div class="container">
      <form action="{% url 'maps:create_job' %}" class="form-horizontal" method="post">
        {% csrf_token %}
        <div class="row py-lg-5">
          <div class="col-lg-6 col-md-8 mx-auto">
            <legend>Create Job for {{ project.project_name }}</legend>
            <div class="mb-3">
              <label for="form-user_id" class="form-label">User</label>
              <input type="text" id="form-user_id" name="user_id">
            </div>
            <div class="mb-3">
              <label for="form-project_id" class="form-label">Project</label>
              <input type="text" id="form-project_id" name="project_id">
            </div>
            <div class="mb-3">
              <label for="form-map_layers" class="form-label">Layers</label>
              <input type="text" id="form-map_layers" name="map_layers">
            </div>
            <div class="mb-3">
              <label for="form-parameters" class="form-label">Parameters</label>
              <textarea type="textarea" id="form-parameters" name="parameters"></textarea>
            </div>
            <div class="mb-3">
              <label for="form-comment" class="form-label">Comment</label>
              <input type="text" id="form-comment" name="comment">
            </div>
            <div class="text-right">
              <button type="submit" class="btn btn-primary mb-3">{% translate 'Submit' %}</button>
            </div>
          </div>
        </div>
      </form>
    </div>
  </div>

</main>
{% endblock content %}

{% block inline_javascript %}
<script>
  let formData = {
      user_id: {{ request.user.id }},
      project_id: {{ project.id }},
      map_layers: [1, 2, 3],
      parameters: {
        'PROJECTID': 'EPSG:9221',
        'VENDORID': '{{ project.vendor_id.name }}',
        'USERID': '{{ request.user.username }}',
        'LAYERS': 'roads, cult_educational_exp_point, lclu_landuse_exp',
        'EXCLUDES': '',
        'CLIP_GEOM': 'POLYGON ((29.5 -28.0, 29.5 -28.1, 29.6 -28.1, 29.6 -28.0, 29.5 -28.0))',
        'OUTPUT_CRS': 'EPSG:9221',
        'PROJECT_CRS': 'EPSG:9221',
      },
      comment: "Generated with nomap form"
    }
    document.getElementById("form-user_id").value = formData.user_id
    document.getElementById("form-project_id").value = formData.project_id
    document.getElementById("form-map_layers").value = '['+formData.map_layers+']'
    document.getElementById("form-parameters").value = JSON.stringify(formData.parameters)
    document.getElementById("form-comment").value = formData.comment
  
</script>
{% endblock inline_javascript %}
